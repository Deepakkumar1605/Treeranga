{% extends 'users/admin/base.html' %}
{% load static %}
{% block title %} Add Product {% endblock title %}
{% block content %}
    
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script>
        $(document).ready(function() {
            // Function to toggle the visibility of product forms based on product type selection
            function toggleProductForms() {
                const productType = $('#id_product_type').val();
                if (productType === 'simple') {
                    $('#simple-product-formset').show(); // Show simple product formset
                } else {
                    $('#simple-product-formset').hide(); // Hide simple product formset
                }
            }

            // Bind the change event of product type selector to the toggle function
            $('#id_product_type').change(function() {
                toggleProductForms();
            });

            // Initial call to ensure correct form visibility on page load
            toggleProductForms();
        });
    </script>

    <h1>Add Product</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <!-- Main product form always visible -->
        {{ form.as_p }}

        <!-- Simple product formset, initially hidden -->
        <div id="simple-product-formset" style="display: none;">
            <h2>Simple Product Details</h2>
            {{ simple_product_formset.management_form }}
            {% for form in simple_product_formset %}
                {{ form.as_p }}
            {% endfor %}
        </div>

        <button type="submit">Save Product</button>
    </form>


{% endblock content %}